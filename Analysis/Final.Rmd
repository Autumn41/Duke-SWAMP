---
title: "Final"
author: "Autumn Dunn"
date: "3/23/2021"
output: pdf_document
---

## Functions used located in `Functions` rmd file ##

Background Information:

####  Water Quality Standards ####

Variables:
- Nitrogen (NOx, TN, NH)
  (TN - Total Nitrogen) EPA Nutrient Ecoregion IX Level III Ecogeion 45 (Piedmont): 800 ug/L 
  (NH - Ammonium) EPA standard for NH: 20 ug/L
  (NOx - Nitrous Oxide) EPA Nutrient Ecoregion IX Level III Ecogeion 45 (Piedmont: 345 ug/L
- Phosphorus (TP - Total Phosphorus)
    EPA Nutrient Ecoregion IX Level III Ecogeion 45 (Piedmont): 30 ug/L
- Fecal Coliform (FC)
    State of NC water quality criteria: 200 colonies/100 mL
- Temperature (Temp)
    NCDENR/DWQ standard for lower Piedmont, non-trout streams: < 32 C
- pH
    NC water quality standard: 6-9
- Sediment (TSS)
    EPA standard for TSS for 30-day average: 30,000 ug/L
    EPA standard for TSS for 7-day average: 45,000 ug/L

####                          ####

###    About SWAMP    ###

SWAMP Information:
- Inflow:
    Phase 1 -- WT1
- Outflow:
    Phase 2 -- WT3
            -- WT5
    
Phase Details:
- Phase 1 = stream reconfigutation
- Phase 2 = dam and impoundment

Site Details:
- WT1 = Downstream of culvert at HWY 751, CONTROL SITE
- WT3 = Upstream of sewer line
- WT5 = Upstream of old dam structure within retention basin of concrete dam, IMPACT SITE

###                   ###

Packages Needed
```{r}
if(!require(pacman))install.packages("pacman")

pacman::p_load(ggpubr, ggplot2, readxl, tidyverse, dplyr, lubridate, here, pkgcond, naniar, arsenal, gam,
               trend, zoo, Kendall, ggforce, plotly, htmlwidgets)

#Set Graph Theme
mytheme <- theme_classic(base_size = 14) +
  theme(axis.text = element_text(color = "black"),
        legend.position = "none") 
theme_set(mytheme)
```

Upload Data
```{r}
Nitrogen             <- read_excel(here("Data/Nitrogen.xlsx"))
Phosphorus           <- read_excel(here("Data/Phosphorus.xlsx"))
TotalSuspendedSolids <- read_excel(here("Data/TotalSuspendedSolids.xlsx"))
YSI                  <- read_excel(here("Data/YSI.xlsx"))
FecalColiform        <- read_excel(here("Data/FecalColiform.xlsx"))
```

Processing Data
```{r}
#combine and isolate SWAMP data
SWAMP_data         <- bind_rows((Nitrogen), Phosphorus, (FecalColiform), (TotalSuspendedSolids), (YSI))

#make pH and Temperature numeric
SWAMP_data$pH      <- as.numeric(SWAMP_data$pH)
SWAMP_data$`Temp C`<- as.numeric(SWAMP_data$`Temp C`)
```

Question 1: How does SWAMP water quality compare to water quality standards?

Daily, Yearly, Monthly means of P3D 
```{r}
P3D_SWAMP <- SWAMP_data %>% 
             filter(Site %in% c("P3D")) %>% 
             filter(Year %in% c(2008:2020))
#dates
DP3D_TN_day     <- WQV_time(P3D_SWAMP, WQV = "Total N (ug/L)", time = "day") %>% 
                   Exceedence(., WQ = "TN" , time = "day", type = "dates")
DP3D_TN_month   <- WQV_time(P3D_SWAMP, WQV = "Total N (ug/L)", time = "month")%>% 
                   Exceedence(., WQ = "TN" , time = "month", type = "dates")
DP3D_TN_year    <- WQV_time(P3D_SWAMP, WQV = "Total N (ug/L)", time = "year")%>% 
                   Exceedence(., WQ = "TN" , time = "year", type = "dates")
DP3D_NH_day     <- WQV_time(P3D_SWAMP, WQV = "NH4-N (ug/L)", time = "day")%>% 
                   Exceedence(., WQ = "NH" , time = "day", type = "dates")
DP3D_NH_month   <- WQV_time(P3D_SWAMP, WQV = "NH4-N (ug/L)", time = "month")%>% 
                   Exceedence(., WQ = "NH" , time = "month", type = "dates")
DP3D_NH_year    <- WQV_time(P3D_SWAMP, WQV = "NH4-N (ug/L)", time = "year")%>% 
                   Exceedence(., WQ = "NH" , time = "year", type = "dates")
DP3D_NOX_day    <- WQV_time(P3D_SWAMP, WQV = "NOX", time = "day")%>% 
                   Exceedence(., WQ = "NOX" , time = "day", type = "dates")
DP3D_NOX_month  <- WQV_time(P3D_SWAMP, WQV = "NOX", time = "month")%>% 
                   Exceedence(., WQ = "NOX" , time = "month", type = "dates")
DP3D_NOX_year   <- WQV_time(P3D_SWAMP, WQV = "NOX", time = "year")%>% 
                   Exceedence(., WQ = "NOX" , time = "year", type = "dates")
DP3D_TP_day     <- WQV_time(P3D_SWAMP, WQV = "UTP", time = "day")%>% 
                   Exceedence(., WQ = "TP" , time = "day", type = "dates")
DP3D_TP_month   <- WQV_time(P3D_SWAMP, WQV = "UTP", time = "month")%>% 
                   Exceedence(., WQ = "TP" , time = "month", type = "dates")
DP3D_TP_year    <- WQV_time(P3D_SWAMP, WQV = "UTP", time = "year")%>% 
                   Exceedence(., WQ = "TP" , time = "year", type = "dates")
DP3D_FC_day     <- WQV_time(P3D_SWAMP, WQV = "FC", time = "day")%>% 
                   Exceedence(., WQ = "FC" , time = "day", type = "dates")
DP3D_FC_month   <- WQV_time(P3D_SWAMP, WQV = "FC", time = "month")%>% 
                   Exceedence(., WQ = "FC" , time = "month", type = "dates")
DP3D_FC_year    <- WQV_time(P3D_SWAMP, WQV = "FC", time = "year")%>% 
                   Exceedence(., WQ = "FC" , time = "year", type = "dates")
DP3D_Temp_day   <- WQV_time(P3D_SWAMP, WQV = "Temp C", time = "day")%>% 
                   Exceedence(., WQ = "Temp" , time = "day", type = "dates")
DP3D_Temp_month <- WQV_time(P3D_SWAMP, WQV = "Temp C", time = "month")%>% 
                   Exceedence(., WQ = "Temp" , time = "month", type = "dates")
DP3D_Temp_year  <- WQV_time(P3D_SWAMP, WQV = "Temp C", time = "year")%>% 
                   Exceedence(., WQ = "Temp" , time = "year", type = "dates")
DP3D_pH_day     <- WQV_time(P3D_SWAMP, WQV = "pH", time = "day")%>% 
                   Exceedence(., WQ = "pH" , time = "day", type = "dates")
DP3D_pH_month   <- WQV_time(P3D_SWAMP, WQV = "pH", time = "month")%>% 
                   Exceedence(., WQ = "pH" , time = "month", type = "dates")
DP3D_pH_year    <- WQV_time(P3D_SWAMP, WQV = "pH", time = "year")%>% 
                   Exceedence(., WQ = "pH" , time = "year", type = "dates")
DP3D_TSS_month  <- WQV_time(P3D_SWAMP, WQV = "TSS (mg/L)", time = "month")%>% 
                   Exceedence(., WQ = "TSS" , time = "month", type = "dates")
DP3D_TSS_year   <- WQV_time(P3D_SWAMP, WQV = "TSS (mg/L)", time = "year")%>% 
                   Exceedence(., WQ = "TSS" , time = "year", type = "dates")

#counts
CP3D_TN_day     <- WQV_time(P3D_SWAMP, WQV = "Total N (ug/L)", time = "day") %>% 
                   Exceedence(., WQ = "TN" , time = "day", type = "counts")
CP3D_TN_month   <- WQV_time(P3D_SWAMP, WQV = "Total N (ug/L)", time = "month")%>% 
                   Exceedence(., WQ = "TN" , time = "month", type = "counts")
CP3D_TN_year    <- WQV_time(P3D_SWAMP, WQV = "Total N (ug/L)", time = "year")%>% 
                   Exceedence(., WQ = "TN" , time = "year", type = "counts")
CP3D_NH_day     <- WQV_time(P3D_SWAMP, WQV = "NH4-N (ug/L)", time = "day")%>% 
                   Exceedence(., WQ = "NH" , time = "day", type = "counts")
CP3D_NH_month   <- WQV_time(P3D_SWAMP, WQV = "NH4-N (ug/L)", time = "month")%>% 
                   Exceedence(., WQ = "NH" , time = "month", type = "counts")
CP3D_NH_year    <- WQV_time(P3D_SWAMP, WQV = "NH4-N (ug/L)", time = "year")%>% 
                   Exceedence(., WQ = "NH" , time = "year", type = "counts")
CP3D_NOX_day    <- WQV_time(P3D_SWAMP, WQV = "NOX", time = "day")%>% 
                   Exceedence(., WQ = "NOX" , time = "day", type = "counts")
CP3D_NOX_month  <- WQV_time(P3D_SWAMP, WQV = "NOX", time = "month")%>% 
                   Exceedence(., WQ = "NOX" , time = "month", type = "counts")
CP3D_NOX_year   <- WQV_time(P3D_SWAMP, WQV = "NOX", time = "year")%>% 
                   Exceedence(., WQ = "NOX" , time = "year", type = "counts")
CP3D_TP_day     <- WQV_time(P3D_SWAMP, WQV = "UTP", time = "day")%>% 
                   Exceedence(., WQ = "TP" , time = "day", type = "counts")
CP3D_TP_month   <- WQV_time(P3D_SWAMP, WQV = "UTP", time = "month")%>% 
                   Exceedence(., WQ = "TP" , time = "month", type = "counts")
CP3D_TP_year    <- WQV_time(P3D_SWAMP, WQV = "UTP", time = "year")%>% 
                   Exceedence(., WQ = "TP" , time = "year", type = "counts")
CP3D_FC_day     <- WQV_time(P3D_SWAMP, WQV = "FC", time = "day")%>% 
                   Exceedence(., WQ = "FC" , time = "day", type = "counts")
CP3D_FC_month   <- WQV_time(P3D_SWAMP, WQV = "FC", time = "month")%>% 
                   Exceedence(., WQ = "FC" , time = "month", type = "counts")
CP3D_FC_year    <- WQV_time(P3D_SWAMP, WQV = "FC", time = "year")%>% 
                   Exceedence(., WQ = "FC" , time = "year", type = "counts")
CP3D_Temp_day   <- WQV_time(P3D_SWAMP, WQV = "Temp C", time = "day")%>% 
                   Exceedence(., WQ = "Temp" , time = "day", type = "counts")
CP3D_Temp_month <- WQV_time(P3D_SWAMP, WQV = "Temp C", time = "month")%>% 
                   Exceedence(., WQ = "Temp" , time = "month", type = "counts")
CP3D_Temp_year  <- WQV_time(P3D_SWAMP, WQV = "Temp C", time = "year")%>% 
                   Exceedence(., WQ = "Temp" , time = "year", type = "counts")
CP3D_pH_day     <- WQV_time(P3D_SWAMP, WQV = "pH", time = "day")%>% 
                   Exceedence(., WQ = "pH" , time = "day", type = "counts")
CP3D_pH_month   <- WQV_time(P3D_SWAMP, WQV = "pH", time = "month")%>% 
                   Exceedence(., WQ = "pH" , time = "month", type = "counts")
CP3D_pH_year    <- WQV_time(P3D_SWAMP, WQV = "pH", time = "year")%>% 
                   Exceedence(., WQ = "pH" , time = "year", type = "counts")
CP3D_TSS_month  <- WQV_time(P3D_SWAMP, WQV = "TSS (mg/L)", time = "month")%>% 
                   Exceedence(., WQ = "TSS" , time = "month", type = "counts")
CP3D_TSS_year   <- WQV_time(P3D_SWAMP, WQV = "TSS (mg/L)", time = "year")%>% 
                   Exceedence(., WQ = "TSS" , time = "year", type = "counts")
```

Daily, Yearly, Monthly means of WT1 
```{r}
WT1_SWAMP <- SWAMP_data %>% 
             filter(Site %in% c("WT1")) %>% 
             filter(Year %in% c(2008:2020))
#dates
DWT1_TN_day     <- WQV_time(WT1_SWAMP, WQV = "Total N (ug/L)", time = "day") %>% 
                   Exceedence(., WQ = "TN" , time = "day", type = "dates")
DWT1_TN_month   <- WQV_time(WT1_SWAMP, WQV = "Total N (ug/L)", time = "month")%>% 
                   Exceedence(., WQ = "TN" , time = "month", type = "dates")
DWT1_TN_year    <- WQV_time(WT1_SWAMP, WQV = "Total N (ug/L)", time = "year")%>% 
                   Exceedence(., WQ = "TN" , time = "year", type = "dates")
DWT1_NH_day     <- WQV_time(WT1_SWAMP, WQV = "NH4-N (ug/L)", time = "day")%>% 
                   Exceedence(., WQ = "NH" , time = "day", type = "dates")
DWT1_NH_month   <- WQV_time(WT1_SWAMP, WQV = "NH4-N (ug/L)", time = "month")%>% 
                   Exceedence(., WQ = "NH" , time = "month", type = "dates")
DWT1_NH_year    <- WQV_time(WT1_SWAMP, WQV = "NH4-N (ug/L)", time = "year")%>% 
                   Exceedence(., WQ = "NH" , time = "year", type = "dates")
DWT1_NOX_day    <- WQV_time(WT1_SWAMP, WQV = "NOX", time = "day")%>% 
                   Exceedence(., WQ = "NOX" , time = "day", type = "dates")
DWT1_NOX_month  <- WQV_time(WT1_SWAMP, WQV = "NOX", time = "month")%>% 
                   Exceedence(., WQ = "NOX" , time = "month", type = "dates")
DWT1_NOX_year   <- WQV_time(WT1_SWAMP, WQV = "NOX", time = "year")%>% 
                   Exceedence(., WQ = "NOX" , time = "year", type = "dates")
DWT1_TP_day     <- WQV_time(WT1_SWAMP, WQV = "UTP", time = "day")%>% 
                   Exceedence(., WQ = "TP" , time = "day", type = "dates")
DWT1_TP_month   <- WQV_time(WT1_SWAMP, WQV = "UTP", time = "month")%>% 
                   Exceedence(., WQ = "TP" , time = "month", type = "dates")
DWT1_TP_year    <- WQV_time(WT1_SWAMP, WQV = "UTP", time = "year")%>% 
                   Exceedence(., WQ = "TP" , time = "year", type = "dates")
DWT1_FC_day     <- WQV_time(WT1_SWAMP, WQV = "FC", time = "day")%>% 
                   Exceedence(., WQ = "FC" , time = "day", type = "dates")
DWT1_FC_month   <- WQV_time(WT1_SWAMP, WQV = "FC", time = "month")%>% 
                   Exceedence(., WQ = "FC" , time = "month", type = "dates")
DWT1_FC_year    <- WQV_time(WT1_SWAMP, WQV = "FC", time = "year")%>% 
                   Exceedence(., WQ = "FC" , time = "year", type = "dates")
DWT1_Temp_day   <- WQV_time(WT1_SWAMP, WQV = "Temp C", time = "day")%>% 
                   Exceedence(., WQ = "Temp" , time = "day", type = "dates")
DWT1_Temp_month <- WQV_time(WT1_SWAMP, WQV = "Temp C", time = "month")%>% 
                   Exceedence(., WQ = "Temp" , time = "month", type = "dates")
DWT1_Temp_year  <- WQV_time(WT1_SWAMP, WQV = "Temp C", time = "year")%>% 
                   Exceedence(., WQ = "Temp" , time = "year", type = "dates")
DWT1_pH_day     <- WQV_time(WT1_SWAMP, WQV = "pH", time = "day")%>% 
                   Exceedence(., WQ = "pH" , time = "day", type = "dates")
DWT1_pH_month   <- WQV_time(WT1_SWAMP, WQV = "pH", time = "month")%>% 
                   Exceedence(., WQ = "pH" , time = "month", type = "dates")
DWT1_pH_year    <- WQV_time(WT1_SWAMP, WQV = "pH", time = "year")%>% 
                   Exceedence(., WQ = "pH" , time = "year", type = "dates")
DWT1_TSS_month  <- WQV_time(WT1_SWAMP, WQV = "TSS (mg/L)", time = "month")%>% 
                   Exceedence(., WQ = "TSS" , time = "month", type = "dates")
DWT1_TSS_year   <- WQV_time(WT1_SWAMP, WQV = "TSS (mg/L)", time = "year")%>% 
                   Exceedence(., WQ = "TSS" , time = "year", type = "dates")

#counts
CWT1_TN_day     <- WQV_time(WT1_SWAMP, WQV = "Total N (ug/L)", time = "day") %>% 
                   Exceedence(., WQ = "TN" , time = "day", type = "counts")
CWT1_TN_month   <- WQV_time(WT1_SWAMP, WQV = "Total N (ug/L)", time = "month")%>% 
                   Exceedence(., WQ = "TN" , time = "month", type = "counts")
CWT1_TN_year    <- WQV_time(WT1_SWAMP, WQV = "Total N (ug/L)", time = "year")%>% 
                   Exceedence(., WQ = "TN" , time = "year", type = "counts")
CWT1_NH_day     <- WQV_time(WT1_SWAMP, WQV = "NH4-N (ug/L)", time = "day")%>% 
                   Exceedence(., WQ = "NH" , time = "day", type = "counts")
CWT1_NH_month   <- WQV_time(WT1_SWAMP, WQV = "NH4-N (ug/L)", time = "month")%>% 
                   Exceedence(., WQ = "NH" , time = "month", type = "counts")
CWT1_NH_year    <- WQV_time(WT1_SWAMP, WQV = "NH4-N (ug/L)", time = "year")%>% 
                   Exceedence(., WQ = "NH" , time = "year", type = "counts")
CWT1_NOX_day    <- WQV_time(WT1_SWAMP, WQV = "NOX", time = "day")%>% 
                   Exceedence(., WQ = "NOX" , time = "day", type = "counts")
CWT1_NOX_month  <- WQV_time(WT1_SWAMP, WQV = "NOX", time = "month")%>% 
                   Exceedence(., WQ = "NOX" , time = "month", type = "counts")
CWT1_NOX_year   <- WQV_time(WT1_SWAMP, WQV = "NOX", time = "year")%>% 
                   Exceedence(., WQ = "NOX" , time = "year", type = "counts")
CWT1_TP_day     <- WQV_time(WT1_SWAMP, WQV = "UTP", time = "day")%>% 
                   Exceedence(., WQ = "TP" , time = "day", type = "counts")
CWT1_TP_month   <- WQV_time(WT1_SWAMP, WQV = "UTP", time = "month")%>% 
                   Exceedence(., WQ = "TP" , time = "month", type = "counts")
CWT1_TP_year    <- WQV_time(WT1_SWAMP, WQV = "UTP", time = "year")%>% 
                   Exceedence(., WQ = "TP" , time = "year", type = "counts")
CWT1_FC_day     <- WQV_time(WT1_SWAMP, WQV = "FC", time = "day")%>% 
                   Exceedence(., WQ = "FC" , time = "day", type = "counts")
CWT1_FC_month   <- WQV_time(WT1_SWAMP, WQV = "FC", time = "month")%>% 
                   Exceedence(., WQ = "FC" , time = "month", type = "counts")
CWT1_FC_year    <- WQV_time(WT1_SWAMP, WQV = "FC", time = "year")%>% 
                   Exceedence(., WQ = "FC" , time = "year", type = "counts")
CWT1_Temp_day   <- WQV_time(WT1_SWAMP, WQV = "Temp C", time = "day")%>% 
                   Exceedence(., WQ = "Temp" , time = "day", type = "counts")
CWT1_Temp_month <- WQV_time(WT1_SWAMP, WQV = "Temp C", time = "month")%>% 
                   Exceedence(., WQ = "Temp" , time = "month", type = "counts")
CWT1_Temp_year  <- WQV_time(WT1_SWAMP, WQV = "Temp C", time = "year")%>% 
                   Exceedence(., WQ = "Temp" , time = "year", type = "counts")
CWT1_pH_day     <- WQV_time(WT1_SWAMP, WQV = "pH", time = "day")%>% 
                   Exceedence(., WQ = "pH" , time = "day", type = "counts")
CWT1_pH_month   <- WQV_time(WT1_SWAMP, WQV = "pH", time = "month")%>% 
                   Exceedence(., WQ = "pH" , time = "month", type = "counts")
CWT1_pH_year    <- WQV_time(WT1_SWAMP, WQV = "pH", time = "year")%>% 
                   Exceedence(., WQ = "pH" , time = "year", type = "counts")
CWT1_TSS_month  <- WQV_time(WT1_SWAMP, WQV = "TSS (mg/L)", time = "month")%>% 
                   Exceedence(., WQ = "TSS" , time = "month", type = "counts")
CWT1_TSS_year   <- WQV_time(WT1_SWAMP, WQV = "TSS (mg/L)", time = "year")%>% 
                   Exceedence(., WQ = "TSS" , time = "year", type = "counts")
```

Daily, Yearly, Monthly means of WT5
```{r}
WT5_SWAMP <- SWAMP_data %>% 
             filter(Site %in% c("WT5")) %>% 
             filter(Year %in% c(2008:2020))

#dates
DWT5_TN_day     <- WQV_time(WT5_SWAMP, WQV = "Total N (ug/L)", time = "day") %>% 
                   Exceedence(., WQ = "TN" , time = "day", type = "dates")
DWT5_TN_month   <- WQV_time(WT5_SWAMP, WQV = "Total N (ug/L)", time = "month")%>% 
                   Exceedence(., WQ = "TN" , time = "month", type = "dates")
DWT5_TN_year    <- WQV_time(WT5_SWAMP, WQV = "Total N (ug/L)", time = "year")%>% 
                   Exceedence(., WQ = "TN" , time = "year", type = "dates")
DWT5_NH_day     <- WQV_time(WT5_SWAMP, WQV = "NH4-N (ug/L)", time = "day")%>% 
                   Exceedence(., WQ = "NH" , time = "day", type = "dates")
DWT5_NH_month   <- WQV_time(WT5_SWAMP, WQV = "NH4-N (ug/L)", time = "month")%>% 
                   Exceedence(., WQ = "NH" , time = "month", type = "dates")
DWT5_NH_year    <- WQV_time(WT5_SWAMP, WQV = "NH4-N (ug/L)", time = "year")%>% 
                   Exceedence(., WQ = "NH" , time = "year", type = "dates")
DWT5_NOX_day    <- WQV_time(WT5_SWAMP, WQV = "NOX", time = "day")%>% 
                   Exceedence(., WQ = "NOX" , time = "day", type = "dates")
DWT5_NOX_month  <- WQV_time(WT3_SWAMP, WQV = "NOX", time = "month")%>% 
                   Exceedence(., WQ = "NOX" , time = "month", type = "dates")
DWT5_NOX_year   <- WQV_time(WT5_SWAMP, WQV = "NOX", time = "year")%>% 
                   Exceedence(., WQ = "NOX" , time = "year", type = "dates")
DWT5_TP_day     <- WQV_time(WT5_SWAMP, WQV = "UTP", time = "day")%>% 
                   Exceedence(., WQ = "TP" , time = "day", type = "dates")
DWT5_TP_month   <- WQV_time(WT5_SWAMP, WQV = "UTP", time = "month")%>% 
                   Exceedence(., WQ = "TP" , time = "month", type = "dates")
DWT5_TP_year    <- WQV_time(WT5_SWAMP, WQV = "UTP", time = "year")%>% 
                   Exceedence(., WQ = "TP" , time = "year", type = "dates")
DWT5_FC_day     <- WQV_time(WT5_SWAMP, WQV = "FC", time = "day")%>% 
                   Exceedence(., WQ = "FC" , time = "day", type = "dates")
DWT5_FC_month   <- WQV_time(WT5_SWAMP, WQV = "FC", time = "month")%>% 
                   Exceedence(., WQ = "FC" , time = "month", type = "dates")
DWT5_FC_year    <- WQV_time(WT5_SWAMP, WQV = "FC", time = "year")%>% 
                   Exceedence(., WQ = "FC" , time = "year", type = "dates")
DWT5_Temp_day   <- WQV_time(WT5_SWAMP, WQV = "Temp C", time = "day")%>% 
                   Exceedence(., WQ = "Temp" , time = "day", type = "dates")
DWT5_Temp_month <- WQV_time(WT5_SWAMP, WQV = "Temp C", time = "month")%>% 
                   Exceedence(., WQ = "Temp" , time = "month", type = "dates")
DWT5_Temp_year  <- WQV_time(WT5_SWAMP, WQV = "Temp C", time = "year")%>% 
                   Exceedence(., WQ = "Temp" , time = "year", type = "dates")
DWT5_pH_day     <- WQV_time(WT5_SWAMP, WQV = "pH", time = "day")%>% 
                   Exceedence(., WQ = "pH" , time = "day", type = "dates")
DWT5_pH_month   <- WQV_time(WT5_SWAMP, WQV = "pH", time = "month")%>% 
                   Exceedence(., WQ = "pH" , time = "month", type = "dates")
DWT5_pH_year    <- WQV_time(WT5_SWAMP, WQV = "pH", time = "year")%>% 
                   Exceedence(., WQ = "pH" , time = "year", type = "dates")
DWT5_TSS_month  <- WQV_time(WT5_SWAMP, WQV = "TSS (mg/L)", time = "month")%>% 
                   Exceedence(., WQ = "TSS" , time = "month", type = "dates")
DWT5_TSS_year   <- WQV_time(WT5_SWAMP, WQV = "TSS (mg/L)", time = "year")%>% 
                   Exceedence(., WQ = "TSS" , time = "year", type = "dates")

#counts
CWT5_TN_day     <- WQV_time(WT5_SWAMP, WQV = "Total N (ug/L)", time = "day") %>% 
                   Exceedence(., WQ = "TN" , time = "day", type = "counts")
CWT5_TN_month   <- WQV_time(WT5_SWAMP, WQV = "Total N (ug/L)", time = "month")%>% 
                   Exceedence(., WQ = "TN" , time = "month", type = "counts")
CWT5_TN_year    <- WQV_time(WT5_SWAMP, WQV = "Total N (ug/L)", time = "year")%>% 
                   Exceedence(., WQ = "TN" , time = "year", type = "counts")
CWT5_NH_day     <- WQV_time(WT5_SWAMP, WQV = "NH4-N (ug/L)", time = "day")%>% 
                   Exceedence(., WQ = "NH" , time = "day", type = "counts")
CWT5_NH_month   <- WQV_time(WT5_SWAMP, WQV = "NH4-N (ug/L)", time = "month")%>% 
                   Exceedence(., WQ = "NH" , time = "month", type = "counts")
CWT5_NH_year    <- WQV_time(WT5_SWAMP, WQV = "NH4-N (ug/L)", time = "year")%>% 
                   Exceedence(., WQ = "NH" , time = "year", type = "counts")
CWT5_NOX_day    <- WQV_time(WT5_SWAMP, WQV = "NOX", time = "day")%>% 
                   Exceedence(., WQ = "NOX" , time = "day", type = "counts")
CWT5_NOX_month  <- WQV_time(WT5_SWAMP, WQV = "NOX", time = "month")%>% 
                   Exceedence(., WQ = "NOX" , time = "month", type = "counts")
CWT5_NOX_year   <- WQV_time(WT5_SWAMP, WQV = "NOX", time = "year")%>% 
                   Exceedence(., WQ = "NOX" , time = "year", type = "counts")
CWT5_TP_day     <- WQV_time(WT5_SWAMP, WQV = "UTP", time = "day")%>% 
                   Exceedence(., WQ = "TP" , time = "day", type = "counts")
CWT5_TP_month   <- WQV_time(WT5_SWAMP, WQV = "UTP", time = "month")%>% 
                   Exceedence(., WQ = "TP" , time = "month", type = "counts")
CWT5_TP_year    <- WQV_time(WT5_SWAMP, WQV = "UTP", time = "year")%>% 
                   Exceedence(., WQ = "TP" , time = "year", type = "counts")
CWT5_FC_day     <- WQV_time(WT5_SWAMP, WQV = "FC", time = "day")%>% 
                   Exceedence(., WQ = "FC" , time = "day", type = "counts")
CWT5_FC_month   <- WQV_time(WT5_SWAMP, WQV = "FC", time = "month")%>% 
                   Exceedence(., WQ = "FC" , time = "month", type = "counts")
CWT5_FC_year    <- WQV_time(WT5_SWAMP, WQV = "FC", time = "year")%>% 
                   Exceedence(., WQ = "FC" , time = "year", type = "counts")
CWT5_Temp_day   <- WQV_time(WT5_SWAMP, WQV = "Temp C", time = "day")%>% 
                   Exceedence(., WQ = "Temp" , time = "day", type = "counts")
CWT5_Temp_month <- WQV_time(WT5_SWAMP, WQV = "Temp C", time = "month")%>% 
                   Exceedence(., WQ = "Temp" , time = "month", type = "counts")
CWT5_Temp_year  <- WQV_time(WT5_SWAMP, WQV = "Temp C", time = "year")%>% 
                   Exceedence(., WQ = "Temp" , time = "year", type = "counts")
CWT5_pH_day     <- WQV_time(WT5_SWAMP, WQV = "pH", time = "day")%>% 
                   Exceedence(., WQ = "pH" , time = "day", type = "counts")
CWT5_pH_month   <- WQV_time(WT5_SWAMP, WQV = "pH", time = "month")%>% 
                   Exceedence(., WQ = "pH" , time = "month", type = "counts")
CWT5_pH_year    <- WQV_time(WT5_SWAMP, WQV = "pH", time = "year")%>% 
                   Exceedence(., WQ = "pH" , time = "year", type = "counts")
CWT5_TSS_month  <- WQV_time(WT5_SWAMP, WQV = "TSS (mg/L)", time = "month")%>% 
                   Exceedence(., WQ = "TSS" , time = "month", type = "counts")
CWT5_TSS_year   <- WQV_time(WT5_SWAMP, WQV = "TSS (mg/L)", time = "year")%>% 
                   Exceedence(., WQ = "TSS" , time = "year", type = "counts")
```

Graphs

P3D
```{r}
#Intercepts
TN_intercept <- log(800)
NH_intercept <- log(20)
TP_intercept <- log(30)
TSS_intercept <- log(30)

#Clean up data for graphs
DP3D_TN_month  <- DP3D_TN_month %>% 
                  mutate(Day = 1) %>% 
                  mutate(Date = ydm(paste0(Year, fix_day(Day), Month, sep="-"))) %>% 
                  select(Monthly.Mean, TN_Exceeded, Date) %>% 
                  mutate(Log = log(Monthly.Mean),
                         Log_Ex = log(TN_Exceeded))
DP3D_NH_month  <- DP3D_NH_month %>% 
                  mutate(Day = 1) %>% 
                  mutate(Date = ydm(paste0(Year, fix_day(Day), Month, sep="-"))) %>% 
                  select(Monthly.Mean, NH_Exceeded, Date) %>% 
                  mutate(Log = log(Monthly.Mean),
                         Log_Ex = log(NH_Exceeded))
DP3D_TP_month  <- DP3D_TP_month %>% 
                  mutate(Day = 1) %>% 
                  mutate(Date = ydm(paste0(Year, fix_day(Day), Month, sep="-"))) %>% 
                  select(Monthly.Mean, TP_Exceeded, Date) %>% 
                  mutate(Log = log(Monthly.Mean),
                         Log_Ex = log(TP_Exceeded))
DP3D_TSS_month <- DP3D_TSS_month %>% 
                  mutate(Day = 1) %>% 
                  mutate(Date = ydm(paste0(Year, fix_day(Day), Month, sep="-"))) %>% 
                  select(Monthly.Mean, TSS_Exceeded, Date) %>% 
                  mutate(Log = log(Monthly.Mean),
                         Log_Ex = log(TSS_Exceeded))

#Graph 9. Monthly average of Pre-treated Site for ammonium. 
Graph9 <- ggplot() +
          geom_point(data = DP3D_NH_month, aes(y = Log, x = Date, colour = Log_Ex, size = Monthly.Mean)) +
          scale_size(range= c(0)) +
          geom_hline(yintercept=NH_intercept) +
          geom_link(aes(x=DP3D_NH_month$Date, y=DP3D_NH_month$Log, 
                        xend = DP3D_NH_month$Date, yend = NH_intercept, 
                        colour = DP3D_NH_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red",
                                labels=c("Low","High"), breaks=c(3.16,6)) +
          xlab("Year") +
          ylab("Log of Mean Ammonium (ug/L)") +
          ggtitle("Monthly Mean Ammonium for SWAMP Pre-Treated Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year")
ggplotly(Graph9, tooltip = c("Date", "Log", "Monthly.Mean"))
Graph9_paper <- ggplot( ) +
          geom_point(data = DP3D_NH_month, aes(y = Log, x = Date, colour = Log_Ex)) +
          geom_hline(yintercept=NH_intercept) +
          geom_link(aes(x=DP3D_NH_month$Date, y=DP3D_NH_month$Log, 
                        xend = DP3D_NH_month$Date, yend = NH_intercept, 
                        colour = DP3D_NH_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red",
                                labels=c("Low","High"), breaks=c(3.16,6)) +
          xlab("Year") +
          ylab("Log of Mean Ammonium (ug/L)") +
          ggtitle("Monthly Mean Ammonium for SWAMP Pre-Treated Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year") +
          mytheme
Graph9_paper


#Graph 10. Monthly average of Pre-Treated Site for total phosphorus. 
Graph10 <- ggplot() +
          geom_point(data = DP3D_TP_month, aes(y = Log, x = Date, colour = Log_Ex, size = Monthly.Mean)) +
          scale_size(range= c(0)) +
          geom_hline(yintercept=TP_intercept) +
          geom_link(aes(x=DP3D_TP_month$Date, y=DP3D_TP_month$Log, 
                        xend = DP3D_TP_month$Date, yend = TP_intercept, 
                        colour = DP3D_TP_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red",
                                labels=c("Low","High"), breaks=c(3.5,5)) +
          xlab("Year") +
          ylab("Log of Total Phosphorus (ug/L)") +
          ggtitle("Monthly Mean Total Phosphorus for SWAMP Pre-Treated Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year")
ggplotly(Graph10, tooltip = c("Date", "Log", "Monthly.Mean"))

Graph10_paper <- ggplot( ) +
          geom_point(data = DP3D_TP_month, aes(y = Log, x = Date, colour = Log_Ex)) +
          geom_hline(yintercept=TP_intercept) +
          geom_link(aes(x=DP3D_TP_month$Date, y=DP3D_TP_month$Log, 
                        xend = DP3D_TP_month$Date, yend = TP_intercept, 
                        colour = DP3D_TP_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red",
                                labels=c("Low","High"), breaks=c(3.5,5)) +
          xlab("Year") +
          ylab("Log of Total Phosphorus (ug/L)") +
          ggtitle("Monthly Mean Total Phosphorus for SWAMP Pre-Treated Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year") +
          mytheme
Graph10_paper


#Graph 11. Monthly average of Pre-Treated Site for total nitrogen. 
Graph11 <- ggplot() +
          geom_point(data = DP3D_TN_month, aes(y = Log, x = Date, 
                                               colour = Log_Ex, size = Monthly.Mean)) +
          scale_size(range= c(0)) +
          geom_hline(yintercept=TN_intercept) +
          geom_link(aes(x=DP3D_TN_month$Date, y=DP3D_TN_month$Log, 
                        xend = DP3D_TN_month$Date, yend = TN_intercept, 
                        colour = DP3D_TN_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red", 
                                labels=c("Low","High"), breaks=c(6.75,7.75)) +
          xlab("Year") +
          ylab("Log of Mean Total Nitrogen (ug/L)") +
          ggtitle("Monthly Mean Total Nitrogen for SWAMP Pre-Treated Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year")
ggplotly(Graph11, tooltip = c("Date", "Log", "Monthly.Mean"))

Graph11_paper <- ggplot( ) +
          geom_point(data = DP3D_TN_month, aes(y = Log, x = Date, colour = Log_Ex)) +
          geom_hline(yintercept=TN_intercept) +
          geom_link(aes(x=DP3D_TN_month$Date, y=DP3D_TN_month$Log, 
                        xend = DP3D_TN_month$Date, yend = TN_intercept, 
                        colour = DP3D_TN_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red", 
                                labels=c("Low","High"), breaks=c(6.75,7.75)) +
          xlab("Year") +
          ylab("Log of Mean Total Nitrogen (ug/L)") +
          ggtitle("Monthly Mean Total Nitrogen for SWAMP Pre-Treated Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year") +
          mytheme
Graph11_paper

#Graph 12. Monthly average of Pre-Treated Site for total suspended solids 
Graph12 <- ggplot() +
          geom_point(data = DP3D_TSS_month, aes(y = Log, x = Date, 
                                               colour = Log_Ex, size = Monthly.Mean)) +
          scale_size(range= c(0)) +
          geom_hline(yintercept=TSS_intercept) +
          geom_link(aes(x=DP3D_TSS_month$Date, y=DP3D_TSS_month$Log, 
                        xend = DP3D_TSS_month$Date, yend = TSS_intercept, 
                        colour = DP3D_TSS_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red", 
                                labels=c("Low","High"), breaks=c(3.5,5.5)) +
          xlab("Year") +
          ylab("Log of Mean Total Suspended Solids (mg/L)") +
          ggtitle("Monthly Mean Total Suspended Solids for SWAMP Pre-Treated Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year")
ggplotly(Graph12, tooltip = c("Date", "Log", "Monthly.Mean"))

Graph12_paper <- ggplot( ) +
          geom_point(data = DP3D_TSS_month, aes(y = Log, x = Date, colour = Log_Ex)) +
          geom_hline(yintercept=TSS_intercept) +
          geom_link(aes(x=DP3D_TSS_month$Date, y=DP3D_TSS_month$Log, 
                        xend = DP3D_TSS_month$Date, yend = TSS_intercept, 
                        colour = DP3D_TSS_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red", 
                                labels=c("Low","High"), breaks=c(3.5,5.5)) +
          xlab("Year") +
          ylab("Log of Mean Total Suspended Solids (mg/L)") +
          ggtitle("Monthly Mean Total Suspended Solids for SWAMP Pre-Treated Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year") +
          mytheme
Graph12_paper

```

WT1
```{r}
#Intercepts
TN_intercept <- log(800)
NH_intercept <- log(20)
TP_intercept <- log(30)
TSS_intercept <- log(30)

#Clean up data for graphs
DWT1_TN_month  <- DWT1_TN_month %>% 
                  mutate(Day = 1) %>% 
                  mutate(Date = ydm(paste0(Year, fix_day(Day), Month, sep="-"))) %>% 
                  select(Monthly.Mean, TN_Exceeded, Date) %>% 
                  mutate(Log = log(Monthly.Mean),
                         Log_Ex = log(TN_Exceeded))
DWT1_NH_month  <- DWT1_NH_month %>% 
                  mutate(Day = 1) %>% 
                  mutate(Date = ydm(paste0(Year, fix_day(Day), Month, sep="-"))) %>% 
                  select(Monthly.Mean, NH_Exceeded, Date) %>% 
                  mutate(Log = log(Monthly.Mean),
                         Log_Ex = log(NH_Exceeded))
DWT1_TP_month  <- DWT1_TP_month %>% 
                  mutate(Day = 1) %>% 
                  mutate(Date = ydm(paste0(Year, fix_day(Day), Month, sep="-"))) %>% 
                  select(Monthly.Mean, TP_Exceeded, Date) %>% 
                  mutate(Log = log(Monthly.Mean),
                         Log_Ex = log(TP_Exceeded))
DWT1_TSS_month <- DWT1_TSS_month %>% 
                  mutate(Day = 1) %>% 
                  mutate(Date = ydm(paste0(Year, fix_day(Day), Month, sep="-"))) %>% 
                  select(Monthly.Mean, TSS_Exceeded, Date) %>% 
                  mutate(Log = log(Monthly.Mean),
                         Log_Ex = log(TSS_Exceeded))

#Graph 1. Monthly average of Inflow Site for ammonium. 
Graph1 <- ggplot() +
          geom_point(data = DWT1_NH_month, aes(y = Log, x = Date, colour = Log_Ex, size = Monthly.Mean)) +
          scale_size(range= c(0)) +
          geom_hline(yintercept=NH_intercept) +
          geom_link(aes(x=DWT1_NH_month$Date, y=DWT1_NH_month$Log, 
                        xend = DWT1_NH_month$Date, yend = NH_intercept, 
                        colour = DWT1_NH_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red",
                                labels=c("Low","High"), breaks=c(3.16,6)) +
          xlab("Year") +
          ylab("Log of Mean Ammonium (ug/L)") +
          ggtitle("Monthly Mean Ammonium for SWAMP Inflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year")
ggplotly(Graph1, tooltip = c("Date", "Log", "Monthly.Mean"))
Graph1_paper <- ggplot( ) +
          geom_point(data = DWT1_NH_month, aes(y = Log, x = Date, colour = Log_Ex)) +
          geom_hline(yintercept=NH_intercept) +
          geom_link(aes(x=DWT1_NH_month$Date, y=DWT1_NH_month$Log, 
                        xend = DWT1_NH_month$Date, yend = NH_intercept, 
                        colour = DWT1_NH_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red",
                                labels=c("Low","High"), breaks=c(3.16,6)) +
          xlab("Year") +
          ylab("Log of Mean Ammonium (ug/L)") +
          ggtitle("Monthly Mean Ammonium for SWAMP Inflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year") +
          mytheme
Graph1_paper


#Graph 2. Monthly average of Inflow Site for total phosphorus. 
Graph2 <- ggplot() +
          geom_point(data = DWT1_TP_month, aes(y = Log, x = Date, colour = Log_Ex, size = Monthly.Mean)) +
          scale_size(range= c(0)) +
          geom_hline(yintercept=TP_intercept) +
          geom_link(aes(x=DWT1_TP_month$Date, y=DWT1_TP_month$Log, 
                        xend = DWT1_TP_month$Date, yend = TP_intercept, 
                        colour = DWT1_TP_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red",
                                labels=c("Low","High"), breaks=c(3.5,5)) +
          xlab("Year") +
          ylab("Log of Total Phosphorus (ug/L)") +
          ggtitle("Monthly Mean Total Phosphorus for SWAMP Inflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year")
ggplotly(Graph2, tooltip = c("Date", "Log", "Monthly.Mean"))

Graph2_paper <- ggplot( ) +
          geom_point(data = DWT1_TP_month, aes(y = Log, x = Date, colour = Log_Ex)) +
          geom_hline(yintercept=TP_intercept) +
          geom_link(aes(x=DWT1_TP_month$Date, y=DWT1_TP_month$Log, 
                        xend = DWT1_TP_month$Date, yend = TP_intercept, 
                        colour = DWT1_TP_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red",
                                labels=c("Low","High"), breaks=c(3.5,5)) +
          xlab("Year") +
          ylab("Log of Total Phosphorus (ug/L)") +
          ggtitle("Monthly Mean Total Phosphorus for SWAMP Inflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year") +
          mytheme
Graph2_paper


#Graph 3. Monthly average of Inflow Site for total nitrogen. 
Graph3 <- ggplot() +
          geom_point(data = DWT1_TN_month, aes(y = Log, x = Date, 
                                               colour = Log_Ex, size = Monthly.Mean)) +
          scale_size(range= c(0)) +
          geom_hline(yintercept=TN_intercept) +
          geom_link(aes(x=DWT1_TN_month$Date, y=DWT1_TN_month$Log, 
                        xend = DWT1_TN_month$Date, yend = TN_intercept, 
                        colour = DWT1_TN_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red", 
                                labels=c("Low","High"), breaks=c(6.75,7.75)) +
          xlab("Year") +
          ylab("Log of Mean Total Nitrogen (ug/L)") +
          ggtitle("Monthly Mean Total Nitrogen for SWAMP Inflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year")
ggplotly(Graph3, tooltip = c("Date", "Log", "Monthly.Mean"))

Graph3_paper <- ggplot( ) +
          geom_point(data = DWT1_TN_month, aes(y = Log, x = Date, colour = Log_Ex)) +
          geom_hline(yintercept=TN_intercept) +
          geom_link(aes(x=DWT1_TN_month$Date, y=DWT1_TN_month$Log, 
                        xend = DWT1_TN_month$Date, yend = TN_intercept, 
                        colour = DWT1_TN_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red", 
                                labels=c("Low","High"), breaks=c(6.75,7.75)) +
          xlab("Year") +
          ylab("Log of Mean Total Nitrogen (ug/L)") +
          ggtitle("Monthly Mean Total Nitrogen for SWAMP Inflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year") +
          mytheme
Graph3_paper

#Graph 4. Monthly average of Inflow Site for total suspended solids 
Graph4 <- ggplot() +
          geom_point(data = DWT1_TSS_month, aes(y = Log, x = Date, 
                                               colour = Log_Ex, size = Monthly.Mean)) +
          scale_size(range= c(0)) +
          geom_hline(yintercept=TSS_intercept) +
          geom_link(aes(x=DWT1_TSS_month$Date, y=DWT1_TSS_month$Log, 
                        xend = DWT1_TSS_month$Date, yend = TSS_intercept, 
                        colour = DWT1_TSS_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red", 
                                labels=c("Low","High"), breaks=c(3.5,5.5)) +
          xlab("Year") +
          ylab("Log of Mean Total Suspended Solids (mg/L)") +
          ggtitle("Monthly Mean Total Suspended Solids for SWAMP Inflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year")
ggplotly(Graph4, tooltip = c("Date", "Log", "Monthly.Mean"))

Graph4_paper <- ggplot( ) +
          geom_point(data = DWT1_TSS_month, aes(y = Log, x = Date, colour = Log_Ex)) +
          geom_hline(yintercept=TSS_intercept) +
          geom_link(aes(x=DWT1_TSS_month$Date, y=DWT1_TSS_month$Log, 
                        xend = DWT1_TSS_month$Date, yend = TSS_intercept, 
                        colour = DWT1_TSS_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red", 
                                labels=c("Low","High"), breaks=c(3.5,5.5)) +
          xlab("Year") +
          ylab("Log of Mean Total Suspended Solids (mg/L)") +
          ggtitle("Monthly Mean Total Suspended Solids for SWAMP Inflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year") +
          mytheme
Graph4_paper

```

WT5
```{r}
#Clean up data for graphs
DWT5_TN_month  <- DWT5_TN_month %>% 
                  mutate(Day = 1) %>% 
                  mutate(Date = ydm(paste0(Year, fix_day(Day), Month, sep="-"))) %>% 
                  select(Monthly.Mean, TN_Exceeded, Date) %>% 
                  mutate(Log = log(Monthly.Mean),
                         Log_Ex = log(TN_Exceeded))
DWT5_NH_month  <- DWT5_NH_month %>% 
                  mutate(Day = 1) %>% 
                  mutate(Date = ydm(paste0(Year, fix_day(Day), Month, sep="-"))) %>% 
                  select(Monthly.Mean, NH_Exceeded, Date) %>% 
                  mutate(Log = log(Monthly.Mean),
                         Log_Ex = log(NH_Exceeded))
DWT5_TP_month  <- DWT5_TP_month %>% 
                  mutate(Day = 1) %>% 
                  mutate(Date = ydm(paste0(Year, fix_day(Day), Month, sep="-"))) %>% 
                  select(Monthly.Mean, TP_Exceeded, Date) %>% 
                  mutate(Log = log(Monthly.Mean),
                         Log_Ex = log(TP_Exceeded))
DWT5_TSS_month <- DWT5_TSS_month %>% 
                  mutate(Day = 1) %>% 
                  mutate(Date = ydm(paste0(Year, fix_day(Day), Month, sep="-"))) %>% 
                  select(Monthly.Mean, TSS_Exceeded, Date) %>% 
                  mutate(Log = log(Monthly.Mean),
                         Log_Ex = log(TSS_Exceeded))

#Graph 5. Monthly average of Outflow Site for ammonium.
Graph5 <- ggplot() +
          geom_point(data = DWT5_NH_month, aes(y = Log, x = Date, colour = Log_Ex, size = Monthly.Mean)) +
          scale_size(range= c(0)) +
          geom_hline(yintercept=NH_intercept) +
          geom_link(aes(x=DWT5_NH_month$Date, y=DWT5_NH_month$Log, 
                        xend = DWT5_NH_month$Date, yend = NH_intercept, 
                        colour = DWT5_NH_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red",
                                labels=c("Low","High"), breaks=c(4,6)) +
          xlab("Year") +
          ylab("Log of Mean Ammonium (ug/L)") +
          ggtitle("Monthly Mean Ammonium for SWAMP Outflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year")
ggplotly(Graph5, tooltip = c("Date", "Log", "Monthly.Mean"))

Graph5_paper <- ggplot( ) +
          geom_point(data = DWT5_NH_month, aes(y = Log, x = Date, colour = Log_Ex)) +
          geom_hline(yintercept=NH_intercept) +
          geom_link(aes(x=DWT5_NH_month$Date, y=DWT5_NH_month$Log, 
                        xend = DWT5_NH_month$Date, yend = NH_intercept, 
                        colour = DWT5_NH_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red",
                                labels=c("Low","High"), breaks=c(4,6)) +
          xlab("Year") +
          ylab("Log of Mean Ammonium (ug/L)") +
          ggtitle("Monthly Mean Ammonium for SWAMP Outflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year") +
          mytheme
Graph5_paper

#Graph 6. Monthly average of Outflow Site for total phosphorus.
Graph6 <- ggplot() +
          geom_point(data = DWT5_TP_month, aes(y = Log, x = Date, colour = Log_Ex, size = Monthly.Mean)) +
          scale_size(range= c(0)) +
          geom_hline(yintercept=TP_intercept) +
          geom_link(aes(x=DWT5_TP_month$Date, y=DWT5_TP_month$Log, 
                        xend = DWT5_TP_month$Date, yend = TP_intercept, 
                        colour = DWT5_TP_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red",
                                labels=c("Low","High"), breaks=c(4,6)) +
          xlab("Year") +
          ylab("Log of Total Phosphorus (ug/L)") +
          ggtitle("Monthly Mean Total Phosphorus for SWAMP Outflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year")
ggplotly(Graph6, tooltip = c("Date", "Log", "Monthly.Mean"))

Graph6_paper <- ggplot( ) +
          geom_point(data = DWT5_TP_month, aes(y = Log, x = Date, colour = Log_Ex)) +
          geom_hline(yintercept=TP_intercept) +
          geom_link(aes(x=DWT5_TP_month$Date, y=DWT5_TP_month$Log, 
                        xend = DWT5_TP_month$Date, yend = TP_intercept, 
                        colour = DWT5_TP_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red",
                                labels=c("Low","High"), breaks=c(4,6)) +
          xlab("Year") +
          ylab("Log of Total Phosphorus (ug/L)") +
          ggtitle("Monthly Mean Total Phosphorus for SWAMP Outflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year") +
          mytheme
Graph6_paper

#Graph 7. Monthly average of Outflow Site for total nitrogen.
Graph7 <- ggplot() +
          geom_point(data = DWT5_TN_month, aes(y = Log, x = Date, 
                                               colour = Log_Ex, size = Monthly.Mean)) +
          scale_size(range= c(0)) +
          geom_hline(yintercept=TN_intercept) +
          geom_link(aes(x=DWT5_TN_month$Date, y=DWT5_TN_month$Log, 
                        xend = DWT5_TN_month$Date, yend = TN_intercept, 
                        colour = DWT5_TN_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red", 
                                labels=c("Low","High"), breaks=c(7,8)) +
          xlab("Year") +
          ylab("Log of Mean Total Nitrogen (ug/L)") +
          ggtitle("Monthly Mean Total Nitrogen for SWAMP Outflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year")
ggplotly(Graph7, tooltip = c("Date", "Log", "Monthly.Mean"))

Graph7_paper <- ggplot( ) +
          geom_point(data = DWT5_TN_month, aes(y = Log, x = Date, colour = Log_Ex)) +
          geom_hline(yintercept=TN_intercept) +
          geom_link(aes(x=DWT5_TN_month$Date, y=DWT5_TN_month$Log, 
                        xend = DWT5_TN_month$Date, yend = TN_intercept, 
                        colour = DWT5_TN_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red", 
                                labels=c("Low","High"), breaks=c(7,8)) +
          xlab("Year") +
          ylab("Log of Mean Total Nitrogen (ug/L)") +
          ggtitle("Monthly Mean Total Nitrogen for SWAMP Outflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year") +
          mytheme
Graph7_paper

#Graph 8. Monthly average of Outflow Site for total suspended solids.
Graph8 <- ggplot() +
          geom_point(data = DWT5_TSS_month, aes(y = Log, x = Date, 
                                               colour = Log_Ex, size = Monthly.Mean)) +
          scale_size(range= c(0)) +
          geom_hline(yintercept=TSS_intercept) +
          geom_link(aes(x=DWT5_TSS_month$Date, y=DWT5_TSS_month$Log, 
                        xend = DWT5_TSS_month$Date, yend = TSS_intercept, 
                        colour = DWT5_TSS_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red", 
                                labels=c("Low","High"), breaks=c(3.5,5.5)) +
          xlab("Year") +
          ylab("Log of Mean Total Suspended Solids (mg/L)") +
          ggtitle("Monthly Mean Total Suspended Solids for SWAMP Outflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year")
ggplotly(Graph8, tooltip = c("Date", "Log", "Monthly.Mean"))

Graph8_paper <- ggplot( ) +
          geom_point(data = DWT5_TSS_month, aes(y = Log, x = Date, colour = Log_Ex)) +
          geom_hline(yintercept=TSS_intercept) +
          geom_link(aes(x=DWT5_TSS_month$Date, y=DWT5_TSS_month$Log, 
                        xend = DWT5_TSS_month$Date, yend = TSS_intercept, 
                        colour = DWT5_TSS_month$Log_Ex)) +
          scale_colour_gradient(name = "Exceeded Water Quality Standard", 
                                low = "red4", high = "red", 
                                labels=c("Low","High"), breaks=c(3.5,5.5)) +
          xlab("Year") +
          ylab("Log of Mean Total Suspended Solids (mg/L)") +
          ggtitle("Monthly Mean Total Suspended Solids for SWAMP Outflow Site" ) + 
          scale_x_date(date_labels = "%Y", breaks = "year") +
          mytheme
Graph8_paper
```

html graphs
```{r}
# save the widget at .html format
G1<-ggplotly(Graph1, tooltip = c("Date", "Log", "Monthly.Mean"))
G2<-ggplotly(Graph2, tooltip = c("Date", "Log", "Monthly.Mean"))
G3<-ggplotly(Graph3, tooltip = c("Date", "Log", "Monthly.Mean"))
G4<-ggplotly(Graph4, tooltip = c("Date", "Log", "Monthly.Mean"))
G5<-ggplotly(Graph5, tooltip = c("Date", "Log", "Monthly.Mean"))
G6<-ggplotly(Graph6, tooltip = c("Date", "Log", "Monthly.Mean"))
G7<-ggplotly(Graph7, tooltip = c("Date", "Log", "Monthly.Mean"))
G8<-ggplotly(Graph8, tooltip = c("Date", "Log", "Monthly.Mean"))

saveWidget(G1, file="Graph1.html")
saveWidget(G2, file="Graph2.html")
saveWidget(G3, file="Graph3.html")
saveWidget(G4, file="Graph4.html")
saveWidget(G5, file="Graph5.html")
saveWidget(G6, file="Graph6.html")
saveWidget(G7, file="Graph7.html")
saveWidget(G8, file="Graph8.html")
```

Question 2: How effective is SWAMP in water quality treatment?

Compare WT1 to WT3
```{r}
#select data for WT1 and WT3 for 2008 - 2020
WT1_5_SWAMP <- SWAMP_data %>% 
                 filter(Site %in% c("WT1", "WT5")) %>% 
                 filter(Year %in% c(2008:2020))

TN_model <- WQV_time(WT1_5_SWAMP, WQV = "Total N (ug/L)", time = "")
NH_model <- WQV_time(WT1_5_SWAMP, WQV = "NH4-N (ug/L)", time = "")
NOX_model <- WQV_time(WT1_5_SWAMP, WQV = "NOX", time = "")
TP_model <- WQV_time(WT1_5_SWAMP, WQV = "UTP", time = "")
Temp_model <- WQV_time(WT1_5_SWAMP, WQV = "Temp C", time = "")
pH_model <- WQV_time(WT1_5_SWAMP, WQV = "pH", time = "")

TSS_model <- WQV_time(WT1_5_SWAMP, WQV = "TSS (mg/L)", time = "") 
TSS_model$`TSS (mg/L)` <-ifelse(TSS_model$`TSS (mg/L)` == 0, 0.001, TSS_model$`TSS (mg/L)`)


FC_model <- WQV_time(WT1_5_SWAMP, WQV = "FC", time = "")
FC_model$FC <-ifelse(FC_model$FC == 0, 0.001, FC_model$FC)

#Model 1 
averageValue(TN_model, WQV = "TN")
averageValue(NH_model, WQV = "NH")
averageValue(NOX_model, WQV = "NOX")
averageValue(TP_model, WQV = "TP")
averageValue(FC_model, WQV = "FC")
averageValue(Temp_model, WQV = "Temp")
averageValue(pH_model, WQV = "ph")
averageValue(TSS_model, WQV = "TSS")
```


Question 3: What are the seasonal trends of SWAMP?

WT1
```{r}
#Clean data for Time Series
WT1_SWAMP <- SWAMP_data %>% 
             filter(Site %in% c("WT1")) %>% 
             filter(Year %in% c(2008:2020))

clean_WT1_TN <- WT1_SWAMP %>% 
             WQV_time(., WQV = "Total N (ug/L)", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT1_NH <- WT1_SWAMP %>% 
             WQV_time(., WQV = "NH4-N (ug/L)", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT1_NOX <- WT1_SWAMP %>% 
             WQV_time(., WQV = "NOX", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT1_TP <- WT1_SWAMP %>% 
             WQV_time(., WQV = "UTP", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT1_FC <- WT1_SWAMP %>% 
             WQV_time(., WQV = "FC", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT1_pH <- WT1_SWAMP %>% 
             WQV_time(., WQV = "pH", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT1_Temp <- WT1_SWAMP %>% 
             WQV_time(., WQV = "Temp C", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT1_TSS <- WT1_SWAMP %>% 
             WQV_time(., WQV = "TSS (mg/L)", time = "month") %>% 
             Fix_Missing_Data(., time = "month")

# Generate time series
ts_WT1_TN          <-TimeSeries(clean_WT1_TN, output = "data", seasonal = "yes")
ts_WT1_Temp        <-TimeSeries(clean_WT1_Temp, output = "data", seasonal = "yes")
ts_WT1_TP          <-TimeSeries(clean_WT1_TP, output = "data", seasonal = "yes")
ts_WT1_NOX         <-TimeSeries(clean_WT1_NOX, output = "data", seasonal = "yes")
ts_WT1_FC          <-TimeSeries(clean_WT1_FC, output = "data", seasonal = "yes")
ts_WT1_TSS         <-TimeSeries(clean_WT1_TSS, output = "data", seasonal = "yes")
ts_WT1_pH          <-TimeSeries(clean_WT1_pH, output = "data", seasonal = "yes")
ts_WT1_NH          <-TimeSeries(clean_WT1_NH, output = "data", seasonal = "yes")

# Generate Non-seasonal time series
nts_WT1_TN          <-TimeSeries(clean_WT1_TN, output = "data", seasonal = "no")
nts_WT1_Temp        <-TimeSeries(clean_WT1_Temp, output = "data", seasonal = "no")
nts_WT1_TP          <-TimeSeries(clean_WT1_TP, output = "data", seasonal = "no")
nts_WT1_NOX         <-TimeSeries(clean_WT1_NOX, output = "data", seasonal = "no")
nts_WT1_FC          <-TimeSeries(clean_WT1_FC, output = "data", seasonal = "no")
nts_WT1_TSS         <-TimeSeries(clean_WT1_TSS, output = "data", seasonal = "no")
nts_WT1_pH          <-TimeSeries(clean_WT1_pH, output = "data", seasonal = "no")
nts_WT1_NH          <-TimeSeries(clean_WT1_NH, output = "data", seasonal = "no")

# Seasonal Summary
TimeSeries(clean_WT1_TN, output = "summary", seasonal = "yes")
TimeSeries(clean_WT1_Temp, output = "summary", seasonal = "yes")
TimeSeries(clean_WT1_TP, output = "summary", seasonal = "yes")
TimeSeries(clean_WT1_NOX, output = "summary", seasonal = "yes")
TimeSeries(clean_WT1_FC, output = "summary", seasonal = "yes")
TimeSeries(clean_WT1_TSS, output = "summary", seasonal = "yes")
TimeSeries(clean_WT1_pH, output = "summary", seasonal = "yes")
TimeSeries(clean_WT1_NH, output = "summary", seasonal = "yes")

# Non-Seasonal Summary
TimeSeries(clean_WT1_TN, output = "summary", seasonal = "no")
TimeSeries(clean_WT1_Temp, output = "summary", seasonal = "no")
TimeSeries(clean_WT1_TP, output = "summary", seasonal = "no")
TimeSeries(clean_WT1_NOX, output = "summary", seasonal = "no")
TimeSeries(clean_WT1_FC, output = "summary", seasonal = "no")
TimeSeries(clean_WT1_TSS, output = "summary", seasonal = "no")
TimeSeries(clean_WT1_pH, output = "summary", seasonal = "no")
TimeSeries(clean_WT1_NH, output = "summary", seasonal = "no")
```

WT3
```{r}
#Clean data for Time Series
clean_WT3_TN <- WT3_SWAMP %>% 
             WQV_time(., WQV = "Total N (ug/L)", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT3_NH <- WT3_SWAMP %>% 
             WQV_time(., WQV = "NH4-N (ug/L)", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT3_NOX <- WT3_SWAMP %>% 
             WQV_time(., WQV = "NOX", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT3_TP <- WT3_SWAMP %>% 
             WQV_time(., WQV = "UTP", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT3_FC <- WT3_SWAMP %>% 
             WQV_time(., WQV = "FC", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT3_pH <- WT3_SWAMP %>% 
             WQV_time(., WQV = "pH", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT3_Temp <- WT3_SWAMP %>% 
             WQV_time(., WQV = "Temp C", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT3_TSS <- WT3_SWAMP %>% 
             WQV_time(., WQV = "TSS (mg/L)", time = "month") %>% 
             Fix_Missing_Data(., time = "month")

# Generate time series
ts_WT3_TN          <-TimeSeries(clean_WT3_TN, output = "data", seasonal = "yes")
ts_WT3_Temp        <-TimeSeries(clean_WT3_Temp, output = "data", seasonal = "yes")
ts_WT3_TP          <-TimeSeries(clean_WT3_TP, output = "data", seasonal = "yes")
ts_WT3_NOX         <-TimeSeries(clean_WT3_NOX, output = "data", seasonal = "yes")
ts_WT3_FC          <-TimeSeries(clean_WT3_FC, output = "data", seasonal = "yes")
ts_WT3_TSS         <-TimeSeries(clean_WT3_TSS, output = "data", seasonal = "yes")
ts_WT3_pH          <-TimeSeries(clean_WT3_pH, output = "data", seasonal = "yes")
ts_WT3_NH          <-TimeSeries(clean_WT3_NH, output = "data", seasonal = "yes")

# Generate Non-seasonal time series
nts_WT3_TN          <-TimeSeries(clean_WT3_TN, output = "data", seasonal = "no")
nts_WT3_Temp        <-TimeSeries(clean_WT3_Temp, output = "data", seasonal = "no")
nts_WT3_TP          <-TimeSeries(clean_WT3_TP, output = "data", seasonal = "no")
nts_WT3_NOX         <-TimeSeries(clean_WT3_NOX, output = "data", seasonal = "no")
nts_WT3_FC          <-TimeSeries(clean_WT3_FC, output = "data", seasonal = "no")
nts_WT3_TSS         <-TimeSeries(clean_WT3_TSS, output = "data", seasonal = "no")
nts_WT3_pH          <-TimeSeries(clean_WT3_pH, output = "data", seasonal = "no")
nts_WT3_NH          <-TimeSeries(clean_WT3_NH, output = "data", seasonal = "no")

# Seasonal Summary
TimeSeries(clean_WT3_TN, output = "summary", seasonal = "yes")
TimeSeries(clean_WT3_Temp, output = "summary", seasonal = "yes")
TimeSeries(clean_WT3_TP, output = "summary", seasonal = "yes")
TimeSeries(clean_WT3_NOX, output = "summary", seasonal = "yes")
TimeSeries(clean_WT3_FC, output = "summary", seasonal = "yes")
TimeSeries(clean_WT3_TSS, output = "summary", seasonal = "yes")
TimeSeries(clean_WT3_pH, output = "summary", seasonal = "yes")
TimeSeries(clean_WT3_NH, output = "summary", seasonal = "yes")

# Non-Seasonal Summary
TimeSeries(clean_WT3_TN, output = "summary", seasonal = "no")
TimeSeries(clean_WT3_Temp, output = "summary", seasonal = "no")
TimeSeries(clean_WT3_TP, output = "summary", seasonal = "no")
TimeSeries(clean_WT3_NOX, output = "summary", seasonal = "no")
TimeSeries(clean_WT3_FC, output = "summary", seasonal = "no")
TimeSeries(clean_WT3_TSS, output = "summary", seasonal = "no")
TimeSeries(clean_WT3_pH, output = "summary", seasonal = "no")
TimeSeries(clean_WT3_NH, output = "summary", seasonal = "no")
```

WT5
```{r}
#Clean data for Time Series
clean_WT5_TN <- WT5_SWAMP %>% 
             WQV_time(., WQV = "Total N (ug/L)", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT5_NH <- WT5_SWAMP %>% 
             WQV_time(., WQV = "NH4-N (ug/L)", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT5_NOX <- WT5_SWAMP %>% 
             WQV_time(., WQV = "NOX", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT5_TP <- WT5_SWAMP %>% 
             WQV_time(., WQV = "UTP", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT5_FC <- WT5_SWAMP %>% 
             WQV_time(., WQV = "FC", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT5_pH <- WT5_SWAMP %>% 
             WQV_time(., WQV = "pH", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT5_Temp <- WT5_SWAMP %>% 
             WQV_time(., WQV = "Temp C", time = "month") %>% 
             Fix_Missing_Data(., time = "month")
clean_WT5_TSS <- WT5_SWAMP %>% 
             WQV_time(., WQV = "TSS (mg/L)", time = "month") %>% 
             Fix_Missing_Data(., time = "month")

# Generate time series
ts_WT5_TN          <-TimeSeries(clean_WT5_TN, output = "data", seasonal = "yes")
ts_WT5_Temp        <-TimeSeries(clean_WT5_Temp, output = "data", seasonal = "yes")
ts_WT5_TP          <-TimeSeries(clean_WT5_TP, output = "data", seasonal = "yes")
ts_WT5_NOX         <-TimeSeries(clean_WT5_NOX, output = "data", seasonal = "yes")
ts_WT5_FC          <-TimeSeries(clean_WT5_FC, output = "data", seasonal = "yes")
ts_WT5_TSS         <-TimeSeries(clean_WT5_TSS, output = "data", seasonal = "yes")
ts_WT5_pH          <-TimeSeries(clean_WT5_pH, output = "data", seasonal = "yes")
ts_WT5_NH          <-TimeSeries(clean_WT5_NH, output = "data", seasonal = "yes")

# Generate Non-seasonal time series
nts_WT5_TN          <-TimeSeries(clean_WT5_TN, output = "data", seasonal = "no")
nts_WT5_Temp        <-TimeSeries(clean_WT5_Temp, output = "data", seasonal = "no")
nts_WT5_TP          <-TimeSeries(clean_WT5_TP, output = "data", seasonal = "no")
nts_WT5_NOX         <-TimeSeries(clean_WT5_NOX, output = "data", seasonal = "no")
nts_WT5_FC          <-TimeSeries(clean_WT5_FC, output = "data", seasonal = "no")
nts_WT5_TSS         <-TimeSeries(clean_WT5_TSS, output = "data", seasonal = "no")
nts_WT5_pH          <-TimeSeries(clean_WT5_pH, output = "data", seasonal = "no")
nts_WT5_NH          <-TimeSeries(clean_WT5_NH, output = "data", seasonal = "no")

# Seasonal Summary
TimeSeries(clean_WT5_TN, output = "summary", seasonal = "yes")
TimeSeries(clean_WT5_Temp, output = "summary", seasonal = "yes")
TimeSeries(clean_WT5_TP, output = "summary", seasonal = "yes")
TimeSeries(clean_WT5_NOX, output = "summary", seasonal = "yes")
TimeSeries(clean_WT5_FC, output = "summary", seasonal = "yes")
TimeSeries(clean_WT5_TSS, output = "summary", seasonal = "yes")
TimeSeries(clean_WT5_pH, output = "summary", seasonal = "yes")
TimeSeries(clean_WT5_NH, output = "summary", seasonal = "yes")

# Non-Seasonal Summary
TimeSeries(clean_WT5_TN, output = "summary", seasonal = "no")
TimeSeries(clean_WT5_Temp, output = "summary", seasonal = "no")
TimeSeries(clean_WT5_TP, output = "summary", seasonal = "no")
TimeSeries(clean_WT5_NOX, output = "summary", seasonal = "no")
TimeSeries(clean_WT5_FC, output = "summary", seasonal = "no")
TimeSeries(clean_WT5_TSS, output = "summary", seasonal = "no")
TimeSeries(clean_WT5_pH, output = "summary", seasonal = "no")
TimeSeries(clean_WT5_NH, output = "summary", seasonal = "no")
```

